args: {
	// The user credentials to be set
	postgresPassword: "toor"

	postgresUser: "root"

	postgresDb: "acorn"

	postgresInitDbArgs: ""

	postgresInitDbWalDir: ""

	postgresHostAuthMethod: ""

	pgData: ""
}

containers: {
	postgresql: {
		image:  "postgres:14.5-bullseye"
		ports: {
			internal: [
               //prometheus monitoring
				"9187:9187"
			]
			expose: "5432:5432"
		}
		env: {
			"POSTGRES_PASSWORD": "secret://root-credentials/password"
			"POSTGRES_USER": "secret://root-credentials/user"
			"POSTGRES_DB": "secret://root-credentials/db"
			"POSTGRES_INITDB_ARGS": "\(args.postgresInitDbArgs)"
			"POSTGRES_INITDB_WALDIR": "\(args.postgresInitDbWalDir)"
			"POSTGRES_HOST_AUTH_METHOD": "\(args.postgresHostAuthMethod)"
			"PGDATA": "\(args.pgData)"
		}
	}
}

secrets: {
	"root-credentials": {
		type: "basic"
		data: {
			password: "\(args.postgresPassword)"
			user: "\(args.postgresUser)"
			db: "\(args.postgresDb)"
		}
	}
}